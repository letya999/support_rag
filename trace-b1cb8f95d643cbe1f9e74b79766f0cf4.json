[
  {
    "id": "597125cb500bc0bf",
    "type": "CHAIN",
    "name": "api_chat_completion (597125cb)",
    "startTime": "2026-01-14T11:07:55.930Z",
    "endTime": "2026-01-14T11:08:02.360Z",
    "depth": 0,
    "input": "{\"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"conversation_context\": [], \"user_id\": \"067e0880-7b26-4aaf-abb9-40fb8331c923\", \"session_id\": \"tg_sess_480637186\", \"hybrid_used\": true, \"confidence_threshold\": 0.3}",
    "output": "{\"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"user_id\": \"067e0880-7b26-4aaf-abb9-40fb8331c923\", \"session_id\": \"tg_sess_480637186\", \"guardrails_passed\": true, \"guardrails_risk_score\": 0.0, \"user_profile\": {\"exists\": true, \"name\": \"\\u0410\\u0440\\u0442\\u0435\\u043c\", \"memory\": {}, \"last_seen\": \"2026-01-12T18:42:15.227112+00:00\"}, \"_session_history_loader\": {}, \"conversation_history\": [], \"aggregated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"extracted_entities\": {}, \"translated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"translation_performed\": true, \"scores\": [0.01639344262295082], \"rerank_scores\": [0.5000080466270447], \"answer\": \"\\u041a\\u043e\\u0439 \\u0443\\u0441\\u0442\\u0440\\u043e\\u0439\\u0441\\u0442\\u0432\\u043e \\u0438\\u0437\\u043f\\u043e\\u043b\\u0437\\u0432\\u0430\\u0442\\u0435 (iOS, Android, Web)?\", \"action\": \"auto_reply\", \"confidence\": 0.5000080466270447, \"matched_intent\": \"technical_issue\", \"matched_category\": \"Technical Support\", \"semantic_intent\": \"unknown\", \"semantic_intent_confidence\": 0.2374468445777893, \"semantic_category\": \"General\", \"semantic_category_confidence\": 0.11056943237781525, \"semantic_time\": 0.06649994850158691, \"best_doc_metadata\": {\"intent\": \"technical_issue\", \"category\": \"Technical Support\", \"extraction_date\": \"2026-01-12T07:06:42.430108\", \"source_document\": \"qa_data_extended.json\", \"confidence_score\": 1.0, \"requires_handoff\": true, \"extraction_method\": \"json_direct\", \"clarifying_questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"confidence_threshold\": 0.8}, \"hybrid_used\": true, \"confidence_threshold\": 0.3, \"filter_used\": false, \"fallback_triggered\": false, \"filtering_reason\": \"No high confidence categories detected\", \"complexity_level\": \"simple\", \"complexity_score\": 0.0, \"merged_context\": \"Question: I have a technical issue with the app\\nAnswer: Please try clearing your cache or reinstalling the application. If the problem persists, contact support.\", \"multihop_used\": false, \"hops_performed\": 0, \"cache_hit\": false, \"cache_key\": \"\\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443 \\u043e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e\", \"clarification_task\": {\"intent\": \"technical_issue\", \"category\": \"Technical Support\", \"extraction_date\": \"2026-01-12T07:06:42.430108\", \"source_document\": \"qa_data_extended.json\", \"confidence_score\": 1.0, \"requires_handoff\": true, \"extraction_method\": \"json_direct\", \"clarifying_questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"confidence_threshold\": 0.8}, \"clarification_context\": {\"active\": true, \"questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"current_index\": 0, \"answers\": {}, \"original_doc_id\": null, \"original_doc_content\": null, \"requires_handoff\": true, \"target_language\": \"bg\"}, \"clarified_doc_ids\": [], \"dialog_state\": \"NEEDS_CLARIFICATION\", \"attempt_count\": 0, \"state_behavior\": {\"tone\": \"professional\", \"action\": \"auto_reply\", \"prompt_hint\": \"standard\"}, \"dialog_analysis\": {\"is_gratitude\": false, \"escalation_requested\": false, \"is_question\": true, \"repeated_question\": false, \"frustration_detected\": false, \"topic_loop_detected\": false, \"refusal\": false, \"topic_shift\": false, \"current_state\": \"NEEDS_CLARIFICATION\", \"confidence_below_threshold\": false, \"requires_handoff\": false}, \"system_prompt\": \"You are a precise technical assistant. Your ONLY task is to ask the specific question provided below. Translate the question to 'bg' (Russian/Spanish/etc) to match the user. Do NOT answer the question. Do NOT add pleasantries. Do NOT hallucinate new questions.\", \"human_prompt\": \"User's previous input: \\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\\n--------------------------------------------------\\nTASK: Ask this EXACT question: \\\"Which device are you using (iOS, Android, Web)?\\\"\\nOutput:\", \"detected_language\": \"bg\", \"language_confidence\": 0.57, \"sentiment\": {\"label\": \"neutral\", \"score\": 0.3}, \"safety_violation\": false, \"safety_reason\": null, \"escalation_requested\": false, \"escalation_decision\": \"auto_reply\", \"escalation_reason\": null, \"action_recommendation\": \"auto_reply\", \"transition_source\": \"maintain_clarification_mode\", \"escalation_triggered\": false, \"escalation_message\": null}",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "0d0980a0a43598ea",
    "type": "CHAIN",
    "name": "session_starter (0d0980a0)",
    "startTime": "2026-01-14T11:07:55.932Z",
    "endTime": "2026-01-14T11:07:55.946Z",
    "depth": 1,
    "input": "{\"user_id\": \"067e0880-7b26-4aaf-abb9-40fb8331c923\", \"session_id\": \"tg_sess_480637186\"}",
    "output": "{\"conversation_history\": [], \"user_profile\": {\"exists\": true, \"name\": \"\\u0410\\u0440\\u0442\\u0435\\u043c\", \"memory\": {}, \"last_seen\": \"2026-01-12T18:42:15.227112+00:00\"}, \"_session_history_loader\": {}, \"attempt_count\": 0, \"_session_metadata\": {\"previous_dialog_state\": \"INITIAL\", \"session_created_at\": null}}",
    "metadata": "{\"tags\":[\"graph:step:1\"],\"langgraph_step\":1,\"langgraph_node\":\"session_starter\",\"langgraph_triggers\":[\"branch:to:session_starter\"],\"langgraph_path\":[\"__pregel_pull\",\"session_starter\"],\"langgraph_checkpoint_ns\":\"session_starter:bb09d5b3-82ac-cc7d-75e0-60ce4b06569d\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "800944e2226ac61e",
    "type": "SPAN",
    "name": "node_session_starter (800944e2)",
    "startTime": "2026-01-14T11:07:55.932Z",
    "endTime": "2026-01-14T11:07:55.945Z",
    "depth": 2,
    "input": "{\"args\": [{\"user_id\": \"067e0880-7b26-4aaf-abb9-40fb8331c923\", \"session_id\": \"tg_sess_480637186\"}], \"kwargs\": {}}",
    "output": "{\"conversation_history\": [], \"user_profile\": {\"exists\": true, \"name\": \"\\u0410\\u0440\\u0442\\u0435\\u043c\", \"memory\": {}, \"last_seen\": \"2026-01-12T18:42:15.227112+00:00\"}, \"_session_history_loader\": {}, \"attempt_count\": 0, \"_session_metadata\": {\"previous_dialog_state\": \"INITIAL\", \"session_created_at\": null}}",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "b2f7b3059a5efb90",
    "type": "CHAIN",
    "name": "input_guardrails (b2f7b305)",
    "startTime": "2026-01-14T11:07:55.947Z",
    "endTime": "2026-01-14T11:07:55.951Z",
    "depth": 1,
    "input": "{\"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\"}",
    "output": "{\"guardrails_passed\": true, \"guardrails_risk_score\": 0.0}",
    "metadata": "{\"tags\":[\"graph:step:2\"],\"langgraph_step\":2,\"langgraph_node\":\"input_guardrails\",\"langgraph_triggers\":[\"branch:to:input_guardrails\"],\"langgraph_path\":[\"__pregel_pull\",\"input_guardrails\"],\"langgraph_checkpoint_ns\":\"input_guardrails:0ee3f7ff-947b-3a1b-b672-301f148d166a\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "3424bf1549610a9f",
    "type": "SPAN",
    "name": "node_input_guardrails (3424bf15)",
    "startTime": "2026-01-14T11:07:55.947Z",
    "endTime": "2026-01-14T11:07:55.949Z",
    "depth": 2,
    "input": "{\"args\": [{\"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\"}], \"kwargs\": {}}",
    "output": "{\"guardrails_passed\": true, \"guardrails_risk_score\": 0.0}",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "3b365fcdbedec052",
    "type": "SPAN",
    "name": "execute (3b365fcd)",
    "startTime": "2026-01-14T11:07:55.948Z",
    "endTime": "2026-01-14T11:07:55.949Z",
    "depth": 3,
    "input": "{\"args\": [{\"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\"}], \"kwargs\": {}}",
    "output": "{\"guardrails_passed\": true, \"guardrails_risk_score\": 0.0}",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "c34483a880b204ce",
    "type": "CHAIN",
    "name": "check_guardrails_and_clarification (c34483a8)",
    "startTime": "2026-01-14T11:07:55.950Z",
    "endTime": "2026-01-14T11:07:55.951Z",
    "depth": 2,
    "input": "{\"guardrails_passed\": true, \"guardrails_risk_score\": 0.0, \"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\"}",
    "output": "{\"output\": \"continue\"}",
    "metadata": "{\"tags\":[\"seq:step:3\"],\"langgraph_step\":2,\"langgraph_node\":\"input_guardrails\",\"langgraph_triggers\":[\"branch:to:input_guardrails\"],\"langgraph_path\":[\"__pregel_pull\",\"input_guardrails\"],\"langgraph_checkpoint_ns\":\"input_guardrails:0ee3f7ff-947b-3a1b-b672-301f148d166a\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "5bdad14ae90ff696",
    "type": "CHAIN",
    "name": "check_cache (5bdad14a)",
    "startTime": "2026-01-14T11:07:55.952Z",
    "endTime": "2026-01-14T11:07:55.957Z",
    "depth": 1,
    "input": "{\"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\"}",
    "output": "{\"cache_hit\": false, \"cache_key\": \"\\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443 \\u043e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e\"}",
    "metadata": "{\"tags\":[\"graph:step:3\"],\"langgraph_step\":3,\"langgraph_node\":\"check_cache\",\"langgraph_triggers\":[\"branch:to:check_cache\"],\"langgraph_path\":[\"__pregel_pull\",\"check_cache\"],\"langgraph_checkpoint_ns\":\"check_cache:eeafbb86-6e86-8a5b-377c-3aa94adaaa76\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "a35bf1f69fd33e4a",
    "type": "SPAN",
    "name": "node_CheckCacheNode (a35bf1f6)",
    "startTime": "2026-01-14T11:07:55.953Z",
    "endTime": "2026-01-14T11:07:55.954Z",
    "depth": 2,
    "input": "{\"args\": [{\"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\"}], \"kwargs\": {}}",
    "output": "{\"cache_hit\": false, \"cache_key\": \"\\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443 \\u043e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e\"}",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "7cedcaf2cd49d08b",
    "type": "CHAIN",
    "name": "cache_hit_logic (7cedcaf2)",
    "startTime": "2026-01-14T11:07:55.955Z",
    "endTime": "2026-01-14T11:07:55.956Z",
    "depth": 2,
    "input": "{\"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"user_id\": \"067e0880-7b26-4aaf-abb9-40fb8331c923\", \"session_id\": \"tg_sess_480637186\", \"guardrails_passed\": true, \"guardrails_risk_score\": 0.0, \"user_profile\": {\"exists\": true, \"name\": \"\\u0410\\u0440\\u0442\\u0435\\u043c\", \"memory\": {}, \"last_seen\": \"2026-01-12T18:42:15.227112+00:00\"}, \"_session_history_loader\": {}, \"conversation_history\": [], \"hybrid_used\": true, \"confidence_threshold\": 0.3, \"cache_hit\": false, \"cache_key\": \"\\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443 \\u043e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e\", \"clarified_doc_ids\": [], \"attempt_count\": 0}",
    "output": "{\"output\": \"miss\"}",
    "metadata": "{\"tags\":[\"seq:step:3\"],\"langgraph_step\":3,\"langgraph_node\":\"check_cache\",\"langgraph_triggers\":[\"branch:to:check_cache\"],\"langgraph_path\":[\"__pregel_pull\",\"check_cache\"],\"langgraph_checkpoint_ns\":\"check_cache:eeafbb86-6e86-8a5b-377c-3aa94adaaa76\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "e8ed0c1ecfa8621a",
    "type": "CHAIN",
    "name": "language_detection (e8ed0c1e)",
    "startTime": "2026-01-14T11:07:55.958Z",
    "endTime": "2026-01-14T11:07:56.619Z",
    "depth": 1,
    "input": "{\"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\"}",
    "output": "{\"detected_language\": \"bg\", \"language_confidence\": 0.57}",
    "metadata": "{\"tags\":[\"graph:step:4\"],\"langgraph_step\":4,\"langgraph_node\":\"language_detection\",\"langgraph_triggers\":[\"branch:to:language_detection\"],\"langgraph_path\":[\"__pregel_pull\",\"language_detection\"],\"langgraph_checkpoint_ns\":\"language_detection:9f53d808-e715-705b-3173-6f24c7d27554\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "55a6420f3ffa9e8a",
    "type": "SPAN",
    "name": "node_LanguageDetectionNode (55a6420f)",
    "startTime": "2026-01-14T11:07:55.958Z",
    "endTime": "2026-01-14T11:07:56.618Z",
    "depth": 2,
    "input": "{\"args\": [{\"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\"}], \"kwargs\": {}}",
    "output": "{\"detected_language\": \"bg\", \"language_confidence\": 0.57}",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "0dc6a2d2931ea600",
    "type": "CHAIN",
    "name": "query_translation (0dc6a2d2)",
    "startTime": "2026-01-14T11:07:56.620Z",
    "endTime": "2026-01-14T11:07:56.640Z",
    "depth": 1,
    "input": "{\"detected_language\": \"bg\", \"language_confidence\": 0.57, \"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\"}",
    "output": "{\"translated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"translation_performed\": true, \"source_language\": \"bg\", \"target_language\": \"en\"}",
    "metadata": "{\"tags\":[\"graph:step:5\"],\"langgraph_step\":5,\"langgraph_node\":\"query_translation\",\"langgraph_triggers\":[\"branch:to:query_translation\"],\"langgraph_path\":[\"__pregel_pull\",\"query_translation\"],\"langgraph_checkpoint_ns\":\"query_translation:756ff0b6-7cee-186c-e9cb-4a6618fd075b\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "dda6d1393d87ed50",
    "type": "SPAN",
    "name": "node_query_translation (dda6d139)",
    "startTime": "2026-01-14T11:07:56.620Z",
    "endTime": "2026-01-14T11:07:56.640Z",
    "depth": 2,
    "input": "{\"args\": [{\"detected_language\": \"bg\", \"language_confidence\": 0.57, \"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\"}], \"kwargs\": {}}",
    "output": "{\"translated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"translation_performed\": true, \"source_language\": \"bg\", \"target_language\": \"en\"}",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "c9398707d2b3657d",
    "type": "CHAIN",
    "name": "dialog_analysis (c9398707)",
    "startTime": "2026-01-14T11:07:56.642Z",
    "endTime": "2026-01-14T11:08:00.196Z",
    "depth": 1,
    "input": "{\"translated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"conversation_history\": [], \"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\"}",
    "output": "{\"dialog_analysis\": {\"is_gratitude\": false, \"escalation_requested\": false, \"is_question\": true, \"repeated_question\": false, \"frustration_detected\": false, \"topic_loop_detected\": false, \"refusal\": false, \"topic_shift\": false}, \"sentiment\": {\"label\": \"neutral\", \"score\": 0.3}, \"safety_violation\": false, \"safety_reason\": null, \"escalation_requested\": false, \"escalation_decision\": \"auto_reply\", \"escalation_reason\": null}",
    "metadata": "{\"tags\":[\"graph:step:6\"],\"langgraph_step\":6,\"langgraph_node\":\"dialog_analysis\",\"langgraph_triggers\":[\"branch:to:dialog_analysis\"],\"langgraph_path\":[\"__pregel_pull\",\"dialog_analysis\"],\"langgraph_checkpoint_ns\":\"dialog_analysis:eadb8d7a-6124-8c95-9255-f070f8ae4b7e\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "545fc6e6f9fb330f",
    "type": "SPAN",
    "name": "node_DialogAnalysisNode (545fc6e6)",
    "startTime": "2026-01-14T11:07:56.642Z",
    "endTime": "2026-01-14T11:08:00.194Z",
    "depth": 2,
    "input": "{\"args\": [{\"translated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"conversation_history\": [], \"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\"}], \"kwargs\": {}}",
    "output": "{\"dialog_analysis\": {\"is_gratitude\": false, \"escalation_requested\": false, \"is_question\": true, \"repeated_question\": false, \"frustration_detected\": false, \"topic_loop_detected\": false, \"refusal\": false, \"topic_shift\": false}, \"sentiment\": {\"label\": \"neutral\", \"score\": 0.3}, \"safety_violation\": false, \"safety_reason\": null, \"escalation_requested\": false, \"escalation_decision\": \"auto_reply\", \"escalation_reason\": null}",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "0d38e4cd86173eb4",
    "type": "SPAN",
    "name": "llm_dialog_analysis_node (0d38e4cd)",
    "startTime": "2026-01-14T11:07:56.643Z",
    "endTime": "2026-01-14T11:08:00.194Z",
    "depth": 3,
    "input": "{\"args\": [{\"translated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"conversation_history\": [], \"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\"}], \"kwargs\": {}}",
    "output": "{\"dialog_analysis\": {\"is_gratitude\": false, \"escalation_requested\": false, \"is_question\": true, \"repeated_question\": false, \"frustration_detected\": false, \"topic_loop_detected\": false, \"refusal\": false, \"topic_shift\": false}, \"sentiment\": {\"label\": \"neutral\", \"score\": 0.3}, \"safety_violation\": false, \"safety_reason\": null, \"escalation_requested\": false, \"escalation_decision\": \"auto_reply\", \"escalation_reason\": null}",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "7a7d7142d94d9049",
    "type": "GENERATION",
    "name": "GENERATION (7a7d7142)",
    "startTime": "2026-01-14T11:07:56.648Z",
    "endTime": "2026-01-14T11:08:00.193Z",
    "depth": 2,
    "input": "[{\"role\": \"user\", \"content\": \"TASK: Classify user's latest support message into 4 categories.\\n\\n=== CLASSIFICATION RULES ===\\n\\n1. SIGNALS (boolean flags):\\n   - is_gratitude: Contains thanks or closing (\\\"\\u0441\\u043f\\u0430\\u0441\\u0438\\u0431\\u043e\\\", \\\"thank you\\\", \\\"\\u0431\\u043b\\u0430\\u0433\\u043e\\u0434\\u0430\\u0440\\u044e\\\", \\\"\\u0445\\u043e\\u0440\\u043e\\u0448\\u0435\\u0433\\u043e \\u0434\\u043d\\u044f\\\", \\\"goodbye\\\")\\n   - escalation_requested: Requests human (\\\"\\u043e\\u043f\\u0435\\u0440\\u0430\\u0442\\u043e\\u0440\\\", \\\"agent\\\", \\\"\\u0447\\u0435\\u043b\\u043e\\u0432\\u0435\\u043a\\\", \\\"\\u043c\\u0435\\u043d\\u0435\\u0434\\u0436\\u0435\\u0440\\\")\\n   - is_question: Asks for help or information (ends with \\\"?\\\", seeks answer)\\n   - repeated_question: Same issue mentioned in history\\n   - refusal: User explicitly refuses to answer or says \\\"I don't know\\\" / \\\"Skip\\\". IMPORTANT: If the previous system message was a Yes/No question, a simple \\\"No\\\" or \\\"Yes\\\" is NOT a refusal.\\n   - topic_shift: User changes subject completely (e.g. from \\\"tech issue\\\" to \\\"pricing\\\")\\n\\n2. SENTIMENT (emotion):\\n   - positive: Happy, satisfied, grateful\\n   - neutral: Informational, calm\\n   - negative: Unhappy, disappointed\\n   - frustrated: Annoyed, impatient\\n   - angry: Very upset, aggressive\\n   - score: 0.0 (calm) to 1.0 (maximum intensity)\\n\\n3. SAFETY (violations):\\n   Mark violation=true IF contains:\\n   - Hate speech, racism, discrimination\\n   - Insults toward staff/bot\\n   - Threats, blackmail\\n   - Off-topic: religion, philosophy, general knowledge\\n\\n4. ESCALATION (routing):\\n   - \\\"escalate\\\" IF: explicit human request OR sentiment=\\\"angry\\\" with score>0.7 OR safety violation\\n   - \\\"auto_reply\\\" OTHERWISE\\n\\n=== EXAMPLES ===\\n\\nExample 1:\\nUser: \\\"\\u0421\\u043f\\u0430\\u0441\\u0438\\u0431\\u043e \\u0437\\u0430 \\u043f\\u043e\\u043c\\u043e\\u0449\\u044c!\\\"\\nOutput: {\\\"signals\\\":{is_gratitude:true,escalation_requested:false,is_question:false,repeated_question:false},\\\"sentiment\\\":{\\\"label\\\":\\\"positive\\\",\\\"score\\\":0.8},\\\"safety\\\":{\\\"violation\\\":false,\\\"reason\\\":null},\\\"escalation\\\":{\\\"decision\\\":\\\"auto_reply\\\",\\\"reason\\\":null}}\\n\\nExample 2:\\nUser: \\\"\\u0421\\u043e\\u0435\\u0434\\u0438\\u043d\\u0438\\u0442\\u0435 \\u043c\\u0435\\u043d\\u044f \\u0441 \\u043e\\u043f\\u0435\\u0440\\u0430\\u0442\\u043e\\u0440\\u043e\\u043c\\\"\\nOutput: {\\\"signals\\\":{is_gratitude:false,escalation_requested:true,is_question:false,repeated_question:false},\\\"sentiment\\\":{\\\"label\\\":\\\"neutral\\\",\\\"score\\\":0.3},\\\"safety\\\":{\\\"violation\\\":false,\\\"reason\\\":null},\\\"escalation\\\":{\\\"decision\\\":\\\"escalate\\\",\\\"reason\\\":\\\"explicit human request\\\"}}\\n\\nExample 3:\\nUser: \\\"\\u0412\\u044b \\u0442\\u0443\\u043f\\u044b\\u0435, \\u043d\\u0438\\u0447\\u0435\\u0433\\u043e \\u043d\\u0435 \\u0440\\u0430\\u0431\\u043e\\u0442\\u0430\\u0435\\u0442!!!\\\"\\nOutput: {\\\"signals\\\":{is_gratitude:false,escalation_requested:false,is_question:false,repeated_question:false,\\\"refusal\\\":false,\\\"topic_shift\\\":false},\\\"sentiment\\\":{\\\"label\\\":\\\"angry\\\",\\\"score\\\":0.9},\\\"safety\\\":{\\\"violation\\\":true,\\\"reason\\\":\\\"insult to staff\\\"},\\\"escalation\\\":{\\\"decision\\\":\\\"escalate\\\",\\\"reason\\\":\\\"safety violation + high anger\\\"}}\\n\\nExample 4:\\nAI: \\\"What is your device?\\\"\\nUser: \\\"I don't know, stop asking.\\\"\\nOutput: {\\\"signals\\\":{is_gratitude:false,escalation_requested:false,is_question:false,repeated_question:false,\\\"refusal\\\":true,\\\"topic_shift\\\":false},\\\"sentiment\\\":{\\\"label\\\":\\\"frustrated\\\",\\\"score\\\":0.6},\\\"safety\\\":{\\\"violation\\\":false,\\\"reason\\\":null},\\\"escalation\\\":{\\\"decision\\\":\\\"auto_reply\\\",\\\"reason\\\":null}}\\n\\nExample 5:\\nAI: \\\"Are you experiencing technical issues?\\\"\\nUser: \\\"No\\\"\\nOutput: {\\\"signals\\\":{is_gratitude:false,escalation_requested:false,is_question:false,repeated_question:false,\\\"refusal\\\":false,\\\"topic_shift\\\":false},\\\"sentiment\\\":{\\\"label\\\":\\\"neutral\\\",\\\"score\\\":0.0},\\\"safety\\\":{\\\"violation\\\":false,\\\"reason\\\":null},\\\"escalation\\\":{\\\"decision\\\":\\\"auto_reply\\\",\\\"reason\\\":null}}\\n\\n=== INPUT DATA ===\\n\\nConversation history:\\n\\n\\nLatest user message:\\n\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\\n\\n=== OUTPUT FORMAT ===\\n\\nOutput ONLY valid JSON matching this EXACT structure:\\n{\\\"signals\\\":{is_gratitude:bool,escalation_requested:bool,is_question:bool,repeated_question:bool,\\\"refusal\\\":bool,\\\"topic_shift\\\":bool},\\\"sentiment\\\":{\\\"label\\\":\\\"positive|neutral|negative|frustrated|angry\\\",\\\"score\\\":0.0-1.0},\\\"safety\\\":{\\\"violation\\\":bool,\\\"reason\\\":\\\"string or null\\\"},\\\"escalation\\\":{\\\"decision\\\":\\\"escalate|auto_reply\\\",\\\"reason\\\":\\\"string or null\\\"}}\\n\\nCRITICAL: Output JSON only. No markdown. No explanation. No prefix text.\"}]",
    "output": "{\"role\": \"assistant\", \"content\": \"{\\\"signals\\\":{\\\"is_gratitude\\\":false,\\\"escalation_requested\\\":false,\\\"is_question\\\":true,\\\"repeated_question\\\":false,\\\"refusal\\\":false,\\\"topic_shift\\\":false},\\\"sentiment\\\":{\\\"label\\\":\\\"neutral\\\",\\\"score\\\":0.3},\\\"safety\\\":{\\\"violation\\\":false,\\\"reason\\\":null},\\\"escalation\\\":{\\\"decision\\\":\\\"auto_reply\\\",\\\"reason\\\":null}}\", \"additional_kwargs\": {\"parsed\": null, \"refusal\": null}}",
    "metadata": "{\"tags\":[\"seq:step:1\"],\"langgraph_step\":6,\"langgraph_node\":\"dialog_analysis\",\"langgraph_triggers\":[\"branch:to:dialog_analysis\"],\"langgraph_path\":[\"__pregel_pull\",\"dialog_analysis\"],\"langgraph_checkpoint_ns\":\"dialog_analysis:eadb8d7a-6124-8c95-9255-f070f8ae4b7e\",\"checkpoint_ns\":\"dialog_analysis:eadb8d7a-6124-8c95-9255-f070f8ae4b7e\",\"ls_provider\":\"openai\",\"ls_model_name\":\"gpt-4o-mini\",\"ls_model_type\":\"chat\",\"ls_temperature\":0,\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "722e285006f35706",
    "type": "CHAIN",
    "name": "should_fast_escalate (722e2850)",
    "startTime": "2026-01-14T11:08:00.195Z",
    "endTime": "2026-01-14T11:08:00.196Z",
    "depth": 2,
    "input": "{\"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"user_id\": \"067e0880-7b26-4aaf-abb9-40fb8331c923\", \"session_id\": \"tg_sess_480637186\", \"guardrails_passed\": true, \"guardrails_risk_score\": 0.0, \"user_profile\": {\"exists\": true, \"name\": \"\\u0410\\u0440\\u0442\\u0435\\u043c\", \"memory\": {}, \"last_seen\": \"2026-01-12T18:42:15.227112+00:00\"}, \"_session_history_loader\": {}, \"conversation_history\": [], \"translated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"translation_performed\": true, \"hybrid_used\": true, \"confidence_threshold\": 0.3, \"cache_hit\": false, \"cache_key\": \"\\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443 \\u043e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e\", \"clarified_doc_ids\": [], \"attempt_count\": 0, \"dialog_analysis\": {\"is_gratitude\": false, \"escalation_requested\": false, \"is_question\": true, \"repeated_question\": false, \"frustration_detected\": false, \"topic_loop_detected\": false, \"refusal\": false, \"topic_shift\": false}, \"detected_language\": \"bg\", \"language_confidence\": 0.57, \"sentiment\": {\"label\": \"neutral\", \"score\": 0.3}, \"safety_violation\": false, \"safety_reason\": null, \"escalation_requested\": false, \"escalation_decision\": \"auto_reply\", \"escalation_reason\": null}",
    "output": "{\"output\": \"continue\"}",
    "metadata": "{\"tags\":[\"seq:step:3\"],\"langgraph_step\":6,\"langgraph_node\":\"dialog_analysis\",\"langgraph_triggers\":[\"branch:to:dialog_analysis\"],\"langgraph_path\":[\"__pregel_pull\",\"dialog_analysis\"],\"langgraph_checkpoint_ns\":\"dialog_analysis:eadb8d7a-6124-8c95-9255-f070f8ae4b7e\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "2b36777a1d33bac1",
    "type": "CHAIN",
    "name": "aggregation (2b36777a)",
    "startTime": "2026-01-14T11:08:00.197Z",
    "endTime": "2026-01-14T11:08:00.199Z",
    "depth": 1,
    "input": "{\"conversation_history\": [], \"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\"}",
    "output": "{\"aggregated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"extracted_entities\": {}}",
    "metadata": "{\"tags\":[\"graph:step:7\"],\"langgraph_step\":7,\"langgraph_node\":\"aggregation\",\"langgraph_triggers\":[\"branch:to:aggregation\"],\"langgraph_path\":[\"__pregel_pull\",\"aggregation\"],\"langgraph_checkpoint_ns\":\"aggregation:4472555d-cfe3-fa8a-8723-7a1013262ff4\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "1c12f148ea8aca07",
    "type": "SPAN",
    "name": "node_AggregationNode (1c12f148)",
    "startTime": "2026-01-14T11:08:00.198Z",
    "endTime": "2026-01-14T11:08:00.198Z",
    "depth": 2,
    "input": "{\"args\": [{\"conversation_history\": [], \"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\"}], \"kwargs\": {}}",
    "output": "{\"aggregated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"extracted_entities\": {}}",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "4b76453a1e6ba904",
    "type": "CHAIN",
    "name": "easy_classification (4b76453a)",
    "startTime": "2026-01-14T11:08:00.200Z",
    "endTime": "2026-01-14T11:08:00.268Z",
    "depth": 1,
    "input": "{\"translated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"aggregated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\"}",
    "output": "{\"semantic_intent\": \"unknown\", \"semantic_intent_confidence\": 0.2374468445777893, \"semantic_category\": \"General\", \"semantic_category_confidence\": 0.11056943237781525, \"semantic_time\": 0.06649994850158691}",
    "metadata": "{\"tags\":[\"graph:step:8\"],\"langgraph_step\":8,\"langgraph_node\":\"easy_classification\",\"langgraph_triggers\":[\"branch:to:easy_classification\"],\"langgraph_path\":[\"__pregel_pull\",\"easy_classification\"],\"langgraph_checkpoint_ns\":\"easy_classification:965a5eb6-ca75-8f40-8773-8dd607f50240\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "d323712181272210",
    "type": "SPAN",
    "name": "node_SemanticClassificationNode (d3237121)",
    "startTime": "2026-01-14T11:08:00.200Z",
    "endTime": "2026-01-14T11:08:00.267Z",
    "depth": 2,
    "input": "{\"args\": [{\"translated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"aggregated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\"}], \"kwargs\": {}}",
    "output": "{\"semantic_intent\": \"unknown\", \"semantic_intent_confidence\": 0.2374468445777893, \"semantic_category\": \"General\", \"semantic_category_confidence\": 0.11056943237781525, \"semantic_time\": 0.06649994850158691}",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "d2c290cb615421f0",
    "type": "CHAIN",
    "name": "metadata_filtering (d2c290cb)",
    "startTime": "2026-01-14T11:08:00.268Z",
    "endTime": "2026-01-14T11:08:00.269Z",
    "depth": 1,
    "input": "{\"semantic_category_confidence\": 0.11056943237781525, \"semantic_category\": \"General\"}",
    "output": "{\"filter_used\": false, \"fallback_triggered\": false, \"filtering_reason\": \"No high confidence categories detected\", \"matched_category\": null}",
    "metadata": "{\"tags\":[\"graph:step:9\"],\"langgraph_step\":9,\"langgraph_node\":\"metadata_filtering\",\"langgraph_triggers\":[\"branch:to:metadata_filtering\"],\"langgraph_path\":[\"__pregel_pull\",\"metadata_filtering\"],\"langgraph_checkpoint_ns\":\"metadata_filtering:ac664a6e-4c9a-6441-d8d3-32aa89174c4c\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "f52470120cb46397",
    "type": "SPAN",
    "name": "node_metadata_filtering (f5247012)",
    "startTime": "2026-01-14T11:08:00.269Z",
    "endTime": "2026-01-14T11:08:00.269Z",
    "depth": 2,
    "input": "{\"args\": [{\"semantic_category_confidence\": 0.11056943237781525, \"semantic_category\": \"General\"}], \"kwargs\": {}}",
    "output": "{\"filter_used\": false, \"fallback_triggered\": false, \"filtering_reason\": \"No high confidence categories detected\", \"matched_category\": null}",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "cd2583d212ef276e",
    "type": "CHAIN",
    "name": "hybrid_search (cd2583d2)",
    "startTime": "2026-01-14T11:08:00.270Z",
    "endTime": "2026-01-14T11:08:00.417Z",
    "depth": 1,
    "input": "{\"translated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"aggregated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"matched_category\": null, \"filter_used\": false, \"detected_language\": \"bg\"}",
    "output": "{\"scores\": [0.01639344262295082], \"confidence\": 0.01639344262295082, \"best_doc_metadata\": {\"intent\": \"technical_issue\", \"category\": \"Technical Support\", \"extraction_date\": \"2026-01-12T07:06:42.430108\", \"source_document\": \"qa_data_extended.json\", \"confidence_score\": 1.0, \"requires_handoff\": true, \"extraction_method\": \"json_direct\", \"clarifying_questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"confidence_threshold\": 0.8}, \"dialog_state\": \"NEEDS_CLARIFICATION\", \"clarification_task\": {\"intent\": \"technical_issue\", \"category\": \"Technical Support\", \"extraction_date\": \"2026-01-12T07:06:42.430108\", \"source_document\": \"qa_data_extended.json\", \"confidence_score\": 1.0, \"requires_handoff\": true, \"extraction_method\": \"json_direct\", \"clarifying_questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"confidence_threshold\": 0.8}}",
    "metadata": "{\"tags\":[\"graph:step:10\"],\"langgraph_step\":10,\"langgraph_node\":\"hybrid_search\",\"langgraph_triggers\":[\"branch:to:hybrid_search\"],\"langgraph_path\":[\"__pregel_pull\",\"hybrid_search\"],\"langgraph_checkpoint_ns\":\"hybrid_search:304f7c41-5f69-5d81-e1a6-4b37b54a9f0f\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "eb0cc84f3a6ebe5b",
    "type": "SPAN",
    "name": "node_HybridSearchNode (eb0cc84f)",
    "startTime": "2026-01-14T11:08:00.271Z",
    "endTime": "2026-01-14T11:08:00.417Z",
    "depth": 2,
    "input": "{\"args\": [{\"translated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"aggregated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"matched_category\": null, \"filter_used\": false, \"detected_language\": \"bg\"}], \"kwargs\": {}}",
    "output": "{\"docs\": [\"Question: I have a technical issue with the app\\nAnswer: Please try clearing your cache or reinstalling the application. If the problem persists, contact support.\"], \"scores\": [0.01639344262295082], \"confidence\": 0.01639344262295082, \"best_doc_metadata\": {\"intent\": \"technical_issue\", \"category\": \"Technical Support\", \"extraction_date\": \"2026-01-12T07:06:42.430108\", \"source_document\": \"qa_data_extended.json\", \"confidence_score\": 1.0, \"requires_handoff\": true, \"extraction_method\": \"json_direct\", \"clarifying_questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"confidence_threshold\": 0.8}, \"dialog_state\": \"NEEDS_CLARIFICATION\", \"clarification_task\": {\"intent\": \"technical_issue\", \"category\": \"Technical Support\", \"extraction_date\": \"2026-01-12T07:06:42.430108\", \"source_document\": \"qa_data_extended.json\", \"confidence_score\": 1.0, \"requires_handoff\": true, \"extraction_method\": \"json_direct\", \"clarifying_questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"confidence_threshold\": 0.8}}",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "6947e05e9df8dd31",
    "type": "SPAN",
    "name": "search_hybrid (6947e05e)",
    "startTime": "2026-01-14T11:08:00.271Z",
    "endTime": "2026-01-14T11:08:00.416Z",
    "depth": 3,
    "input": "{\"args\": [\"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\"], \"kwargs\": {\"top_k\": 5, \"category_filter\": null, \"detected_language\": \"bg\"}}",
    "output": "[{\"content\": \"Question: I have a technical issue with the app\\nAnswer: Please try clearing your cache or reinstalling the application. If the problem persists, contact support.\", \"metadata\": {\"intent\": \"technical_issue\", \"category\": \"Technical Support\", \"extraction_date\": \"2026-01-12T07:06:42.430108\", \"source_document\": \"qa_data_extended.json\", \"confidence_score\": 1.0, \"requires_handoff\": true, \"extraction_method\": \"json_direct\", \"clarifying_questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"confidence_threshold\": 0.8}, \"score\": 0.01639344262295082}]",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "b65a2090635a56c5",
    "type": "SPAN",
    "name": "lexical_search_node (b65a2090)",
    "startTime": "2026-01-14T11:08:00.271Z",
    "endTime": "2026-01-14T11:08:00.299Z",
    "depth": 4,
    "input": "{\"args\": [\"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\"], \"kwargs\": {\"top_k\": 10, \"detected_language\": \"bg\", \"category_filter\": null}}",
    "output": "[]",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "a3331a9764a80f75",
    "type": "SPAN",
    "name": "lexical_search_db (a3331a97)",
    "startTime": "2026-01-14T11:08:00.271Z",
    "endTime": "2026-01-14T11:08:00.299Z",
    "depth": 5,
    "input": "{\"args\": [\"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\"], \"kwargs\": {\"top_k\": 10, \"detected_language\": \"bg\", \"category_filter\": null}}",
    "output": "[]",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "f967376275368e5c",
    "type": "SPAN",
    "name": "vector_search (f9673762)",
    "startTime": "2026-01-14T11:08:00.336Z",
    "endTime": "2026-01-14T11:08:00.416Z",
    "depth": 4,
    "input": "{\"args\": [[0.04289082810282707, 0.02645457535982132, -0.09950532019138336, -0.07670872658491135, 0.022892333567142487, -0.0694434717297554, 0.03799017146229744, 0.026770800352096558, 0.024299917742609978, 0.033695023506879807, 0.05061376094818115, -0.0029307776130735874, 0.07251223176717758, -0.045311253517866135, -0.04197508469223976, 0.06453162431716919, 0.057621993124485016, -0.01766420528292656, -0.036638904362916946, -0.07145047187805176, 0.034442607313394547, -0.03563036769628525, -0.03832012042403221, 0.03283637762069702, 0.05155671760439873, 0.10253417491912842, -0.035898566246032715, 0.02472962811589241, 0.03919399529695511, -0.07582548260688782, -0.04324352368712425, 0.004540672991424799, 0.0510062612593174, -0.06848569959402084, 0.06658138334751129, 0.05041069537401199, -0.06195581331849098, -0.01883183792233467, 0.06178059056401253, -0.06204080209136009, -0.0261185634881258, 0.021540548652410507, 0.045178961008787155, 0.05590847507119179, 0.07700926810503006, 0.045799870043992996, -0.056882452219724655, 0.03696382790803909, -0.035855866968631744, -0.04680433124303818, -0.07486117631196976, 0.045893944799900055, 0.037498071789741516, 0.04836592450737953, 0.027714500203728676, -0.057171475142240524, -0.07547691464424133, -0.08661097288131714, -0.05863545835018158, -0.005225819069892168, 0.04693429172039032, -0.03834778815507889, 0.0005170828080736101, 0.015091360546648502, 0.045084644109010696, 0.05308840423822403, 0.045630309730768204, 0.024652360007166862, -0.06339048594236374, -0.02942809648811817, -0.06393688172101974, -0.0031600554939359426, -0.01965312846004963, -0.028434744104743004, 0.01013607531785965, 0.01988326385617256, 0.003886209800839424, -0.033594340085983276, 0.0267178937792778, -0.02862703800201416, -0.08405416458845139, -0.02510617859661579, -0.043623317033052444, 0.06835711747407913, -0.02321700006723404, 0.07745739817619324, 0.03996669128537178, -0.06266222894191742, 0.08304391801357269, -0.04257236048579216, 0.05677169933915138, 0.06378813832998276, -0.0879390686750412, -0.03563521429896355, -0.08219020068645477, -0.027708003297448158, -0.04811853915452957, 0.05117587745189667, 0.0371684804558754, -0.05332348868250847, 0.0757472962141037, -0.03804878145456314, 0.012505542486906052, -0.053007904440164566, 0.015350926667451859, 0.016587920486927032, 0.0589967742562294, -0.07005235552787781, 0.030973341315984726, -0.038529932498931885, -0.01720321737229824, 0.06034870073199272, 0.04554874449968338, 0.061915185302495956, -0.1367538869380951, -0.01628667302429676, -0.09251762926578522, -0.033034443855285645, 0.060587409883737564, -0.040403686463832855, 0.07239559292793274, -0.008669156581163406, -0.050579983741045, -0.040609221905469894, -0.04071950912475586, -0.045443687587976456, 0.00046836488763801754, 0.07945870608091354, 0.03884126991033554, 0.015523133799433708, 0.05662122368812561, 0.03256990388035774, 0.011102293618023396, 0.05422040820121765, 0.053033798933029175, 0.06657599657773972, -0.029201887547969818, 0.047424715012311935, -0.05216328427195549, -0.03378666564822197, -0.028107713907957077, 0.060433365404605865, -0.040389832109212875, 0.029905186966061592, 0.024737458676099777, 0.07074205577373505, 0.055537786334753036, 0.031148361042141914, 0.05830829218029976, -0.05249345675110817, 0.029939305037260056, -0.03744306042790413, 0.059604279696941376, 0.01829073578119278, 0.03834093362092972, -0.03640728443861008, -0.10339992493391037, -0.038856085389852524, 0.026545876637101173, 0.03614209592342377, -0.059617865830659866, -0.07236874103546143, -0.06665819138288498, -0.011468591168522835, -0.04678811877965927, -0.06372928619384766, 0.022819068282842636, 0.08393020182847977, -0.06603513658046722, -0.04151415824890137, -0.05077743902802467, 0.03230554983019829, -0.03516076132655144, 0.0566926933825016, 0.012573971413075924, 0.04079126566648483, 0.003166459733620286, 0.044299278408288956, 0.05360401049256325, 0.02364552766084671, -0.008688212372362614, -0.04860964044928551, -0.08790487796068192, -0.03137192130088806, -0.05741400271654129, -0.01920485869050026, -0.0721418634057045, 0.004893118515610695, 0.050990309566259384, -0.01384369470179081, 0.008792256936430931, 0.057565946131944656, -0.04910053685307503, -0.09372687339782715, -0.0361177884042263, -0.008968246169388294, -0.04668603092432022, 0.06576916575431824, 0.062044981867074966, -0.0003162040375173092, -0.03144286572933197, -0.07567596435546875, 0.06997509300708771, 0.017844218760728836, 0.06827283650636673, 0.028429178521037102, -0.08302342146635056, 0.043744247406721115, -0.043363288044929504, 0.05885227769613266, 0.08179602771997452, -0.08388686925172806, -0.08487062901258469, 0.033306192606687546, -0.049993161112070084, -0.03773011267185211, 0.0236644446849823, 0.060003794729709625, -0.08991742879152298, 0.02389509603381157, 0.04011804237961769, -0.009792396798729897, 0.02335093729197979, -0.094375379383564, 0.005166179500520229, 0.014883683063089848, 0.03025483712553978, -0.07914067059755325, -0.04443536698818207, 0.05908206105232239, -0.06841573119163513, -0.020239219069480896, -0.05520208925008774, -0.060730941593647, -0.03415394574403763, -0.07915406674146652, -0.018470127135515213, 0.05598406121134758, 0.02545802854001522, -0.06032592058181763, -0.03186315670609474, -0.03177923709154129, 0.037286557257175446, -0.0754924938082695, 0.04742347449064255, -0.07237908989191055, 0.006127149797976017, 0.0601671077311039, 0.007121549919247627, 0.0711977630853653, 0.03190865367650986, -0.0423339419066906, -0.0017320933984592557, -0.08545307070016861, -0.0329856276512146, 0.03608596697449684, 0.04717417433857918, 0.04703988879919052, -0.07963508367538452, 0.0308391060680151, 0.07178471237421036, -0.040657252073287964, 0.034650836139917374, 0.07865777611732483, 0.0883510559797287, 0.01595388539135456, -0.07746807485818863, -0.0462031289935112, -0.06887993216514587, -0.011633622460067272, -0.03981662169098854, 0.042736031115055084, 0.11687274277210236, -0.04031530022621155, -0.04271472245454788, -0.0560893788933754, 0.06721168756484985, 0.10675494372844696, -0.06898964941501617, -0.023583145812153816, 0.0665193498134613, 0.034944791346788406, 0.07415098696947098, 0.05240079015493393, 0.061394039541482925, -0.0315711684525013, -5.5328502639895305e-05, 0.08222439885139465, 0.0023954985663294792, -0.03096804954111576, -0.029228711500763893, -0.04139455780386925, 0.07234002649784088, -0.06024183705449104, 0.05556146800518036, 0.008977100253105164, 0.012231070548295975, 0.035001594573259354, -0.07381732761859894, 0.07749444246292114, -0.005390476435422897, -0.04137315973639488, -0.007878289557993412, -0.007617579307407141, -0.0487629696726799, 0.05426228418946266, 0.012214742600917816, 0.07185506075620651, 0.03560826927423477, 0.03195144608616829, 0.06519399583339691, 0.04136726260185242, -0.06529804319143295, -0.04087498039007187, 0.010727704502642155, 0.009405212476849556, -0.06512115895748138, -0.006090313196182251, -0.05399582162499428, -0.0149266691878438, -0.04885903373360634, -0.04821648821234703, -0.029638100415468216, -0.0720614492893219, 0.043282292783260345, 0.022062724456191063, -0.028647970408201218, -0.007624644786119461, 0.0518486462533474, 0.023352045565843582, 0.02414204739034176, -0.07282167673110962, -0.05114084482192993, 0.051437363028526306, -0.04855836555361748, -0.0012258972274139524, -0.03625901788473129, 0.05113741755485535, -0.049257583916187286, -0.03530754894018173, 0.024852218106389046, 0.017057670280337334, -0.07145173102617264, 0.07167727500200272, -0.09170613437891006, -0.05379851534962654, 0.07282661646604538, -0.023475227877497673, -0.056673940271139145, 0.060651443898677826, 0.026828859001398087, -0.07633721828460693, 0.00883258506655693, 0.0944063663482666, 0.0018779670353978872, 0.029855040833353996, -0.057727936655282974, -0.01004481129348278, 0.01759655773639679, 0.04636778309941292, -0.03213013336062431, -0.06139708682894707, 0.04291791841387749, 0.06669269502162933, 0.0802164152264595, 0.05365533009171486, -0.026573700830340385, -0.016324631869792938, 0.016045959666371346, -0.05686166509985924, 0.09192861616611481, 0.03884730115532875, -0.035003911703825, 0.019845368340611458, 0.010328909382224083, -0.06111816316843033, -0.0009955473942682147, 0.05812165141105652, -0.05347800999879837, -0.029524272307753563, 0.05361524969339371, 0.036050643771886826, -0.006766559090465307, 0.07183735817670822]], \"kwargs\": {\"top_k\": 10, \"category_filter\": null}}",
    "output": "[{\"content\": \"Question: I have a technical issue with the app\\nAnswer: Please try clearing your cache or reinstalling the application. If the problem persists, contact support.\", \"metadata\": {\"intent\": \"technical_issue\", \"category\": \"Technical Support\", \"extraction_date\": \"2026-01-12T07:06:42.430108\", \"source_document\": \"qa_data_extended.json\", \"confidence_score\": 1.0, \"requires_handoff\": true, \"extraction_method\": \"json_direct\", \"clarifying_questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"confidence_threshold\": 0.8}, \"score\": 0.779058575630188}]",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "aca1f78bbc4de9e2",
    "type": "CHAIN",
    "name": "reranking (aca1f78b)",
    "startTime": "2026-01-14T11:08:00.418Z",
    "endTime": "2026-01-14T11:08:00.743Z",
    "depth": 1,
    "input": "{\"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\"}",
    "output": "{\"rerank_scores\": [0.5000080466270447], \"best_rerank_score\": 0.5000080466270447, \"confidence\": 0.5000080466270447}",
    "metadata": "{\"tags\":[\"graph:step:11\"],\"langgraph_step\":11,\"langgraph_node\":\"reranking\",\"langgraph_triggers\":[\"branch:to:reranking\"],\"langgraph_path\":[\"__pregel_pull\",\"reranking\"],\"langgraph_checkpoint_ns\":\"reranking:312fd3aa-9f6a-7cf7-2d19-ce31fa08ad7f\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "150cb9d65ef45e9f",
    "type": "SPAN",
    "name": "node_RerankingNode (150cb9d6)",
    "startTime": "2026-01-14T11:08:00.419Z",
    "endTime": "2026-01-14T11:08:00.742Z",
    "depth": 2,
    "input": "{\"args\": [{\"docs\": [\"Question: I have a technical issue with the app\\nAnswer: Please try clearing your cache or reinstalling the application. If the problem persists, contact support.\"], \"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\"}], \"kwargs\": {}}",
    "output": "{\"docs\": [\"Question: I have a technical issue with the app\\nAnswer: Please try clearing your cache or reinstalling the application. If the problem persists, contact support.\"], \"rerank_scores\": [0.5000080466270447], \"best_rerank_score\": 0.5000080466270447, \"confidence\": 0.5000080466270447}",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "8022ac9350252fc1",
    "type": "CHAIN",
    "name": "multihop (8022ac93)",
    "startTime": "2026-01-14T11:08:00.744Z",
    "endTime": "2026-01-14T11:08:00.746Z",
    "depth": 1,
    "input": "{\"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"best_doc_metadata\": {\"intent\": \"technical_issue\", \"category\": \"Technical Support\", \"extraction_date\": \"2026-01-12T07:06:42.430108\", \"source_document\": \"qa_data_extended.json\", \"confidence_score\": 1.0, \"requires_handoff\": true, \"extraction_method\": \"json_direct\", \"clarifying_questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"confidence_threshold\": 0.8}, \"scores\": [0.01639344262295082], \"confidence\": 0.5000080466270447, \"rerank_scores\": [0.5000080466270447]}",
    "output": "{\"complexity_level\": \"simple\", \"complexity_score\": 0.0, \"multihop_used\": false, \"hops_performed\": 0, \"merged_context\": \"Question: I have a technical issue with the app\\nAnswer: Please try clearing your cache or reinstalling the application. If the problem persists, contact support.\", \"confidence\": 0.5000080466270447}",
    "metadata": "{\"tags\":[\"graph:step:12\"],\"langgraph_step\":12,\"langgraph_node\":\"multihop\",\"langgraph_triggers\":[\"branch:to:multihop\"],\"langgraph_path\":[\"__pregel_pull\",\"multihop\"],\"langgraph_checkpoint_ns\":\"multihop:144d009c-101f-8af0-a69d-3f9c4650d6d9\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "57756b8ca1c95a87",
    "type": "SPAN",
    "name": "node_MultihopNode (57756b8c)",
    "startTime": "2026-01-14T11:08:00.744Z",
    "endTime": "2026-01-14T11:08:00.744Z",
    "depth": 2,
    "input": "{\"args\": [{\"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"docs\": [\"Question: I have a technical issue with the app\\nAnswer: Please try clearing your cache or reinstalling the application. If the problem persists, contact support.\"], \"best_doc_metadata\": {\"intent\": \"technical_issue\", \"category\": \"Technical Support\", \"extraction_date\": \"2026-01-12T07:06:42.430108\", \"source_document\": \"qa_data_extended.json\", \"confidence_score\": 1.0, \"requires_handoff\": true, \"extraction_method\": \"json_direct\", \"clarifying_questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"confidence_threshold\": 0.8}, \"scores\": [0.01639344262295082], \"confidence\": 0.5000080466270447, \"rerank_scores\": [0.5000080466270447]}], \"kwargs\": {}}",
    "output": "{\"complexity_level\": \"simple\", \"complexity_score\": 0.0, \"multihop_used\": false, \"hops_performed\": 0, \"merged_context\": \"Question: I have a technical issue with the app\\nAnswer: Please try clearing your cache or reinstalling the application. If the problem persists, contact support.\", \"docs\": [\"Question: I have a technical issue with the app\\nAnswer: Please try clearing your cache or reinstalling the application. If the problem persists, contact support.\"], \"confidence\": 0.5000080466270447}",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "68246a3f0c1eba24",
    "type": "CHAIN",
    "name": "route_after_retrieval (68246a3f)",
    "startTime": "2026-01-14T11:08:00.745Z",
    "endTime": "2026-01-14T11:08:00.746Z",
    "depth": 2,
    "input": "{\"complexity_level\": \"simple\", \"complexity_score\": 0.0, \"multihop_used\": false, \"hops_performed\": 0, \"merged_context\": \"Question: I have a technical issue with the app\\nAnswer: Please try clearing your cache or reinstalling the application. If the problem persists, contact support.\", \"confidence\": 0.5000080466270447, \"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"best_doc_metadata\": {\"intent\": \"technical_issue\", \"category\": \"Technical Support\", \"extraction_date\": \"2026-01-12T07:06:42.430108\", \"source_document\": \"qa_data_extended.json\", \"confidence_score\": 1.0, \"requires_handoff\": true, \"extraction_method\": \"json_direct\", \"clarifying_questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"confidence_threshold\": 0.8}, \"scores\": [0.01639344262295082], \"rerank_scores\": [0.5000080466270447]}",
    "output": "{\"output\": \"clarification_questions\"}",
    "metadata": "{\"tags\":[\"seq:step:3\"],\"langgraph_step\":12,\"langgraph_node\":\"multihop\",\"langgraph_triggers\":[\"branch:to:multihop\"],\"langgraph_path\":[\"__pregel_pull\",\"multihop\"],\"langgraph_checkpoint_ns\":\"multihop:144d009c-101f-8af0-a69d-3f9c4650d6d9\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "99cbd92f86fd624e",
    "type": "CHAIN",
    "name": "clarification_questions (99cbd92f)",
    "startTime": "2026-01-14T11:08:00.747Z",
    "endTime": "2026-01-14T11:08:02.222Z",
    "depth": 1,
    "input": "{\"clarification_task\": {\"intent\": \"technical_issue\", \"category\": \"Technical Support\", \"extraction_date\": \"2026-01-12T07:06:42.430108\", \"source_document\": \"qa_data_extended.json\", \"confidence_score\": 1.0, \"requires_handoff\": true, \"extraction_method\": \"json_direct\", \"clarifying_questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"confidence_threshold\": 0.8}, \"conversation_history\": [], \"best_doc_metadata\": {\"intent\": \"technical_issue\", \"category\": \"Technical Support\", \"extraction_date\": \"2026-01-12T07:06:42.430108\", \"source_document\": \"qa_data_extended.json\", \"confidence_score\": 1.0, \"requires_handoff\": true, \"extraction_method\": \"json_direct\", \"clarifying_questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"confidence_threshold\": 0.8}, \"dialog_state\": \"NEEDS_CLARIFICATION\", \"detected_language\": \"bg\", \"clarified_doc_ids\": []}",
    "output": "{\"answer\": \"\\u041a\\u043e\\u0439 \\u0443\\u0441\\u0442\\u0440\\u043e\\u0439\\u0441\\u0442\\u0432\\u043e \\u0438\\u0437\\u043f\\u043e\\u043b\\u0437\\u0432\\u0430\\u0442\\u0435 (iOS, Android, Web)?\", \"clarification_context\": {\"active\": true, \"questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"current_index\": 0, \"answers\": {}, \"original_doc_id\": null, \"original_doc_content\": null, \"requires_handoff\": true, \"target_language\": \"bg\"}, \"dialog_state\": \"NEEDS_CLARIFICATION\"}",
    "metadata": "{\"tags\":[\"graph:step:13\"],\"langgraph_step\":13,\"langgraph_node\":\"clarification_questions\",\"langgraph_triggers\":[\"branch:to:clarification_questions\"],\"langgraph_path\":[\"__pregel_pull\",\"clarification_questions\"],\"langgraph_checkpoint_ns\":\"clarification_questions:761eb4f9-f787-ed81-4c5e-99fb4f016508\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "c3bde46fa7dea59e",
    "type": "SPAN",
    "name": "node_ClarificationQuestionsNode (c3bde46f)",
    "startTime": "2026-01-14T11:08:00.748Z",
    "endTime": "2026-01-14T11:08:02.221Z",
    "depth": 2,
    "input": "{\"args\": [{\"clarification_task\": {\"intent\": \"technical_issue\", \"category\": \"Technical Support\", \"extraction_date\": \"2026-01-12T07:06:42.430108\", \"source_document\": \"qa_data_extended.json\", \"confidence_score\": 1.0, \"requires_handoff\": true, \"extraction_method\": \"json_direct\", \"clarifying_questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"confidence_threshold\": 0.8}, \"conversation_history\": [], \"best_doc_metadata\": {\"intent\": \"technical_issue\", \"category\": \"Technical Support\", \"extraction_date\": \"2026-01-12T07:06:42.430108\", \"source_document\": \"qa_data_extended.json\", \"confidence_score\": 1.0, \"requires_handoff\": true, \"extraction_method\": \"json_direct\", \"clarifying_questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"confidence_threshold\": 0.8}, \"dialog_state\": \"NEEDS_CLARIFICATION\", \"detected_language\": \"bg\", \"clarified_doc_ids\": []}], \"kwargs\": {}}",
    "output": "{\"answer\": \"\\u041a\\u043e\\u0439 \\u0443\\u0441\\u0442\\u0440\\u043e\\u0439\\u0441\\u0442\\u0432\\u043e \\u0438\\u0437\\u043f\\u043e\\u043b\\u0437\\u0432\\u0430\\u0442\\u0435 (iOS, Android, Web)?\", \"clarification_context\": {\"active\": true, \"questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"current_index\": 0, \"answers\": {}, \"original_doc_id\": null, \"original_doc_content\": null, \"requires_handoff\": true, \"target_language\": \"bg\"}, \"dialog_state\": \"NEEDS_CLARIFICATION\"}",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "c11a496be45ee5aa",
    "type": "SPAN",
    "name": "execute (c11a496b)",
    "startTime": "2026-01-14T11:08:00.748Z",
    "endTime": "2026-01-14T11:08:02.221Z",
    "depth": 3,
    "input": "{\"args\": [{\"clarification_task\": {\"intent\": \"technical_issue\", \"category\": \"Technical Support\", \"extraction_date\": \"2026-01-12T07:06:42.430108\", \"source_document\": \"qa_data_extended.json\", \"confidence_score\": 1.0, \"requires_handoff\": true, \"extraction_method\": \"json_direct\", \"clarifying_questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"confidence_threshold\": 0.8}, \"conversation_history\": [], \"best_doc_metadata\": {\"intent\": \"technical_issue\", \"category\": \"Technical Support\", \"extraction_date\": \"2026-01-12T07:06:42.430108\", \"source_document\": \"qa_data_extended.json\", \"confidence_score\": 1.0, \"requires_handoff\": true, \"extraction_method\": \"json_direct\", \"clarifying_questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"confidence_threshold\": 0.8}, \"dialog_state\": \"NEEDS_CLARIFICATION\", \"detected_language\": \"bg\", \"clarified_doc_ids\": []}], \"kwargs\": {}}",
    "output": "{\"answer\": \"\\u041a\\u043e\\u0439 \\u0443\\u0441\\u0442\\u0440\\u043e\\u0439\\u0441\\u0442\\u0432\\u043e \\u0438\\u0437\\u043f\\u043e\\u043b\\u0437\\u0432\\u0430\\u0442\\u0435 (iOS, Android, Web)?\", \"clarification_context\": {\"active\": true, \"questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"current_index\": 0, \"answers\": {}, \"original_doc_id\": null, \"original_doc_content\": null, \"requires_handoff\": true, \"target_language\": \"bg\"}, \"dialog_state\": \"NEEDS_CLARIFICATION\"}",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "da0260abc596e72b",
    "type": "CHAIN",
    "name": "RunnableSequence (da0260ab)",
    "startTime": "2026-01-14T11:08:00.750Z",
    "endTime": "2026-01-14T11:08:02.220Z",
    "depth": 2,
    "input": "{\"language\": \"bg\", \"question\": \"Which device are you using (iOS, Android, Web)?\"}",
    "output": "{\"content\": \"\\u041a\\u043e\\u0439 \\u0443\\u0441\\u0442\\u0440\\u043e\\u0439\\u0441\\u0442\\u0432\\u043e \\u0438\\u0437\\u043f\\u043e\\u043b\\u0437\\u0432\\u0430\\u0442\\u0435 (iOS, Android, Web)?\", \"additional_kwargs\": {}, \"response_metadata\": {\"finish_reason\": \"stop\", \"model_name\": \"gpt-4o-mini-2024-07-18\", \"system_fingerprint\": \"fp_29330a9688\", \"service_tier\": \"default\", \"model_provider\": \"openai\"}, \"type\": \"ai\", \"name\": null, \"id\": \"lc_run--019bbc30-e970-7830-bbfc-af1e90dfa070\", \"tool_calls\": [], \"invalid_tool_calls\": [], \"usage_metadata\": {\"input_tokens\": 46, \"output_tokens\": 14, \"total_tokens\": 60, \"input_token_details\": {\"audio\": 0, \"cache_read\": 0}, \"output_token_details\": {\"audio\": 0, \"reasoning\": 0}}}",
    "metadata": "{\"tags\":[\"seq:step:1\",\"clarification_llm\"],\"langgraph_step\":13,\"langgraph_node\":\"clarification_questions\",\"langgraph_triggers\":[\"branch:to:clarification_questions\"],\"langgraph_path\":[\"__pregel_pull\",\"clarification_questions\"],\"langgraph_checkpoint_ns\":\"clarification_questions:761eb4f9-f787-ed81-4c5e-99fb4f016508\",\"checkpoint_ns\":\"clarification_questions:761eb4f9-f787-ed81-4c5e-99fb4f016508\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "e8633dee9bfec9b9",
    "type": "CHAIN",
    "name": "ChatPromptTemplate (e8633dee)",
    "startTime": "2026-01-14T11:08:00.751Z",
    "endTime": "2026-01-14T11:08:00.751Z",
    "depth": 3,
    "input": "{\"language\": \"bg\", \"question\": \"Which device are you using (iOS, Android, Web)?\"}",
    "output": "{\"messages\": [{\"content\": \"Translate the following support question into bg. Keep the tone professional and friendly. Do not add any preamble or quotes.\\n\\nQuestion: Which device are you using (iOS, Android, Web)?\", \"additional_kwargs\": {}, \"response_metadata\": {}, \"type\": \"human\", \"name\": null, \"id\": null}]}",
    "metadata": "{\"tags\":[\"seq:step:1\",\"clarification_llm\"],\"langgraph_step\":13,\"langgraph_node\":\"clarification_questions\",\"langgraph_triggers\":[\"branch:to:clarification_questions\"],\"langgraph_path\":[\"__pregel_pull\",\"clarification_questions\"],\"langgraph_checkpoint_ns\":\"clarification_questions:761eb4f9-f787-ed81-4c5e-99fb4f016508\",\"checkpoint_ns\":\"clarification_questions:761eb4f9-f787-ed81-4c5e-99fb4f016508\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "6f2260696c2c29ff",
    "type": "GENERATION",
    "name": "GENERATION (6f226069)",
    "startTime": "2026-01-14T11:08:00.752Z",
    "endTime": "2026-01-14T11:08:02.220Z",
    "depth": 3,
    "input": "[{\"role\": \"user\", \"content\": \"Translate the following support question into bg. Keep the tone professional and friendly. Do not add any preamble or quotes.\\n\\nQuestion: Which device are you using (iOS, Android, Web)?\"}]",
    "output": "{\"role\": \"assistant\", \"content\": \"\\u041a\\u043e\\u0439 \\u0443\\u0441\\u0442\\u0440\\u043e\\u0439\\u0441\\u0442\\u0432\\u043e \\u0438\\u0437\\u043f\\u043e\\u043b\\u0437\\u0432\\u0430\\u0442\\u0435 (iOS, Android, Web)?\"}",
    "metadata": "{\"tags\":[\"seq:step:2\",\"clarification_llm\"],\"langgraph_step\":13,\"langgraph_node\":\"clarification_questions\",\"langgraph_triggers\":[\"branch:to:clarification_questions\"],\"langgraph_path\":[\"__pregel_pull\",\"clarification_questions\"],\"langgraph_checkpoint_ns\":\"clarification_questions:761eb4f9-f787-ed81-4c5e-99fb4f016508\",\"checkpoint_ns\":\"clarification_questions:761eb4f9-f787-ed81-4c5e-99fb4f016508\",\"ls_provider\":\"openai\",\"ls_model_name\":\"gpt-4o-mini\",\"ls_model_type\":\"chat\",\"ls_temperature\":0,\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "a4acebda21be357c",
    "type": "CHAIN",
    "name": "state_machine (a4acebda)",
    "startTime": "2026-01-14T11:08:02.223Z",
    "endTime": "2026-01-14T11:08:02.224Z",
    "depth": 1,
    "input": "{\"confidence_threshold\": 0.3, \"best_doc_metadata\": {\"intent\": \"technical_issue\", \"category\": \"Technical Support\", \"extraction_date\": \"2026-01-12T07:06:42.430108\", \"source_document\": \"qa_data_extended.json\", \"confidence_score\": 1.0, \"requires_handoff\": true, \"extraction_method\": \"json_direct\", \"clarifying_questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"confidence_threshold\": 0.8}, \"dialog_analysis\": {\"is_gratitude\": false, \"escalation_requested\": false, \"is_question\": true, \"repeated_question\": false, \"frustration_detected\": false, \"topic_loop_detected\": false, \"refusal\": false, \"topic_shift\": false}, \"confidence\": 0.5000080466270447, \"dialog_state\": \"NEEDS_CLARIFICATION\", \"safety_violation\": false, \"attempt_count\": 0, \"escalation_decision\": \"auto_reply\", \"sentiment\": {\"label\": \"neutral\", \"score\": 0.3}}",
    "output": "{\"dialog_state\": \"NEEDS_CLARIFICATION\", \"action_recommendation\": \"auto_reply\"}",
    "metadata": "{\"tags\":[\"graph:step:14\"],\"langgraph_step\":14,\"langgraph_node\":\"state_machine\",\"langgraph_triggers\":[\"branch:to:state_machine\"],\"langgraph_path\":[\"__pregel_pull\",\"state_machine\"],\"langgraph_checkpoint_ns\":\"state_machine:3fe5d80d-6c36-3d51-a090-3cda959da498\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "698a104425544a68",
    "type": "SPAN",
    "name": "node_state_machine (698a1044)",
    "startTime": "2026-01-14T11:08:02.223Z",
    "endTime": "2026-01-14T11:08:02.223Z",
    "depth": 2,
    "input": "{\"args\": [{\"confidence_threshold\": 0.3, \"docs\": [\"Question: I have a technical issue with the app\\nAnswer: Please try clearing your cache or reinstalling the application. If the problem persists, contact support.\"], \"best_doc_metadata\": {\"intent\": \"technical_issue\", \"category\": \"Technical Support\", \"extraction_date\": \"2026-01-12T07:06:42.430108\", \"source_document\": \"qa_data_extended.json\", \"confidence_score\": 1.0, \"requires_handoff\": true, \"extraction_method\": \"json_direct\", \"clarifying_questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"confidence_threshold\": 0.8}, \"dialog_analysis\": {\"is_gratitude\": false, \"escalation_requested\": false, \"is_question\": true, \"repeated_question\": false, \"frustration_detected\": false, \"topic_loop_detected\": false, \"refusal\": false, \"topic_shift\": false}, \"confidence\": 0.5000080466270447, \"dialog_state\": \"NEEDS_CLARIFICATION\", \"safety_violation\": false, \"attempt_count\": 0, \"escalation_decision\": \"auto_reply\", \"sentiment\": {\"label\": \"neutral\", \"score\": 0.3}}], \"kwargs\": {}}",
    "output": "{\"dialog_state\": \"NEEDS_CLARIFICATION\", \"attempt_count\": 0, \"state_behavior\": {\"tone\": \"professional\", \"action\": \"auto_reply\", \"prompt_hint\": \"standard\"}, \"action_recommendation\": \"auto_reply\", \"escalation_reason\": null, \"transition_source\": \"maintain_clarification_mode\"}",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "589ed6d5b85788ec",
    "type": "CHAIN",
    "name": "routing (589ed6d5)",
    "startTime": "2026-01-14T11:08:02.225Z",
    "endTime": "2026-01-14T11:08:02.228Z",
    "depth": 1,
    "input": "{\"confidence_threshold\": 0.3, \"action_recommendation\": \"auto_reply\", \"answer\": \"\\u041a\\u043e\\u0439 \\u0443\\u0441\\u0442\\u0440\\u043e\\u0439\\u0441\\u0442\\u0432\\u043e \\u0438\\u0437\\u043f\\u043e\\u043b\\u0437\\u0432\\u0430\\u0442\\u0435 (iOS, Android, Web)?\", \"best_doc_metadata\": {\"intent\": \"technical_issue\", \"category\": \"Technical Support\", \"extraction_date\": \"2026-01-12T07:06:42.430108\", \"source_document\": \"qa_data_extended.json\", \"confidence_score\": 1.0, \"requires_handoff\": true, \"extraction_method\": \"json_direct\", \"clarifying_questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"confidence_threshold\": 0.8}, \"detected_language\": \"bg\", \"confidence\": 0.5000080466270447, \"escalation_requested\": false, \"dialog_state\": \"NEEDS_CLARIFICATION\", \"safety_violation\": false, \"escalation_reason\": null}",
    "output": "{\"action\": \"auto_reply\"}",
    "metadata": "{\"tags\":[\"graph:step:15\"],\"langgraph_step\":15,\"langgraph_node\":\"routing\",\"langgraph_triggers\":[\"branch:to:routing\"],\"langgraph_path\":[\"__pregel_pull\",\"routing\"],\"langgraph_checkpoint_ns\":\"routing:de4e6a92-f4ae-8e29-251a-9a0d697e6727\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "b4a911972ad6ebb4",
    "type": "SPAN",
    "name": "node_RoutingNode (b4a91197)",
    "startTime": "2026-01-14T11:08:02.225Z",
    "endTime": "2026-01-14T11:08:02.225Z",
    "depth": 2,
    "input": "{\"args\": [{\"confidence_threshold\": 0.3, \"action_recommendation\": \"auto_reply\", \"answer\": \"\\u041a\\u043e\\u0439 \\u0443\\u0441\\u0442\\u0440\\u043e\\u0439\\u0441\\u0442\\u0432\\u043e \\u0438\\u0437\\u043f\\u043e\\u043b\\u0437\\u0432\\u0430\\u0442\\u0435 (iOS, Android, Web)?\", \"best_doc_metadata\": {\"intent\": \"technical_issue\", \"category\": \"Technical Support\", \"extraction_date\": \"2026-01-12T07:06:42.430108\", \"source_document\": \"qa_data_extended.json\", \"confidence_score\": 1.0, \"requires_handoff\": true, \"extraction_method\": \"json_direct\", \"clarifying_questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"confidence_threshold\": 0.8}, \"detected_language\": \"bg\", \"confidence\": 0.5000080466270447, \"escalation_requested\": false, \"dialog_state\": \"NEEDS_CLARIFICATION\", \"safety_violation\": false, \"escalation_reason\": null}], \"kwargs\": {}}",
    "output": "{\"action\": \"auto_reply\", \"matched_intent\": \"technical_issue\", \"matched_category\": \"Technical Support\", \"routing_reason\": null, \"routing_confidence\": 0.5000080466270447, \"routing_threshold\": 0.3, \"escalation_triggered\": false, \"escalation_message\": null}",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "3ba772b0747cf49d",
    "type": "CHAIN",
    "name": "router_logic (3ba772b0)",
    "startTime": "2026-01-14T11:08:02.226Z",
    "endTime": "2026-01-14T11:08:02.228Z",
    "depth": 2,
    "input": "{\"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"user_id\": \"067e0880-7b26-4aaf-abb9-40fb8331c923\", \"session_id\": \"tg_sess_480637186\", \"guardrails_passed\": true, \"guardrails_risk_score\": 0.0, \"user_profile\": {\"exists\": true, \"name\": \"\\u0410\\u0440\\u0442\\u0435\\u043c\", \"memory\": {}, \"last_seen\": \"2026-01-12T18:42:15.227112+00:00\"}, \"_session_history_loader\": {}, \"conversation_history\": [], \"aggregated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"extracted_entities\": {}, \"translated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"translation_performed\": true, \"scores\": [0.01639344262295082], \"rerank_scores\": [0.5000080466270447], \"answer\": \"\\u041a\\u043e\\u0439 \\u0443\\u0441\\u0442\\u0440\\u043e\\u0439\\u0441\\u0442\\u0432\\u043e \\u0438\\u0437\\u043f\\u043e\\u043b\\u0437\\u0432\\u0430\\u0442\\u0435 (iOS, Android, Web)?\", \"action\": \"auto_reply\", \"confidence\": 0.5000080466270447, \"matched_intent\": \"technical_issue\", \"matched_category\": \"Technical Support\", \"semantic_intent\": \"unknown\", \"semantic_intent_confidence\": 0.2374468445777893, \"semantic_category\": \"General\", \"semantic_category_confidence\": 0.11056943237781525, \"semantic_time\": 0.06649994850158691, \"best_doc_metadata\": {\"intent\": \"technical_issue\", \"category\": \"Technical Support\", \"extraction_date\": \"2026-01-12T07:06:42.430108\", \"source_document\": \"qa_data_extended.json\", \"confidence_score\": 1.0, \"requires_handoff\": true, \"extraction_method\": \"json_direct\", \"clarifying_questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"confidence_threshold\": 0.8}, \"hybrid_used\": true, \"confidence_threshold\": 0.3, \"filter_used\": false, \"fallback_triggered\": false, \"filtering_reason\": \"No high confidence categories detected\", \"complexity_level\": \"simple\", \"complexity_score\": 0.0, \"merged_context\": \"Question: I have a technical issue with the app\\nAnswer: Please try clearing your cache or reinstalling the application. If the problem persists, contact support.\", \"multihop_used\": false, \"hops_performed\": 0, \"cache_hit\": false, \"cache_key\": \"\\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443 \\u043e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e\", \"clarification_task\": {\"intent\": \"technical_issue\", \"category\": \"Technical Support\", \"extraction_date\": \"2026-01-12T07:06:42.430108\", \"source_document\": \"qa_data_extended.json\", \"confidence_score\": 1.0, \"requires_handoff\": true, \"extraction_method\": \"json_direct\", \"clarifying_questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"confidence_threshold\": 0.8}, \"clarification_context\": {\"active\": true, \"questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"current_index\": 0, \"answers\": {}, \"original_doc_id\": null, \"original_doc_content\": null, \"requires_handoff\": true, \"target_language\": \"bg\"}, \"clarified_doc_ids\": [], \"dialog_state\": \"NEEDS_CLARIFICATION\", \"attempt_count\": 0, \"state_behavior\": {\"tone\": \"professional\", \"action\": \"auto_reply\", \"prompt_hint\": \"standard\"}, \"dialog_analysis\": {\"is_gratitude\": false, \"escalation_requested\": false, \"is_question\": true, \"repeated_question\": false, \"frustration_detected\": false, \"topic_loop_detected\": false, \"refusal\": false, \"topic_shift\": false, \"current_state\": \"NEEDS_CLARIFICATION\", \"confidence_below_threshold\": false, \"requires_handoff\": false}, \"detected_language\": \"bg\", \"language_confidence\": 0.57, \"sentiment\": {\"label\": \"neutral\", \"score\": 0.3}, \"safety_violation\": false, \"safety_reason\": null, \"escalation_requested\": false, \"escalation_decision\": \"auto_reply\", \"escalation_reason\": null, \"action_recommendation\": \"auto_reply\", \"transition_source\": \"maintain_clarification_mode\", \"escalation_triggered\": false, \"escalation_message\": null}",
    "output": "{\"output\": \"generation\"}",
    "metadata": "{\"tags\":[\"seq:step:3\"],\"langgraph_step\":15,\"langgraph_node\":\"routing\",\"langgraph_triggers\":[\"branch:to:routing\"],\"langgraph_path\":[\"__pregel_pull\",\"routing\"],\"langgraph_checkpoint_ns\":\"routing:de4e6a92-f4ae-8e29-251a-9a0d697e6727\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "0dec08d51cb5bc97",
    "type": "CHAIN",
    "name": "prompt_routing (0dec08d5)",
    "startTime": "2026-01-14T11:08:02.229Z",
    "endTime": "2026-01-14T11:08:02.319Z",
    "depth": 1,
    "input": "{\"clarification_context\": {\"active\": true, \"questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"current_index\": 0, \"answers\": {}, \"original_doc_id\": null, \"original_doc_content\": null, \"requires_handoff\": true, \"target_language\": \"bg\"}, \"state_behavior\": {\"tone\": \"professional\", \"action\": \"auto_reply\", \"prompt_hint\": \"standard\"}, \"_session_history_loader\": {}, \"aggregated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"conversation_history\": [], \"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"extracted_entities\": {}, \"dialog_state\": \"NEEDS_CLARIFICATION\", \"detected_language\": \"bg\", \"user_profile\": {\"exists\": true, \"name\": \"\\u0410\\u0440\\u0442\\u0435\\u043c\", \"memory\": {}, \"last_seen\": \"2026-01-12T18:42:15.227112+00:00\"}}",
    "output": "{\"system_prompt\": \"You are a precise technical assistant. Your ONLY task is to ask the specific question provided below. Translate the question to 'bg' (Russian/Spanish/etc) to match the user. Do NOT answer the question. Do NOT add pleasantries. Do NOT hallucinate new questions.\", \"human_prompt\": \"User's previous input: \\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\\n--------------------------------------------------\\nTASK: Ask this EXACT question: \\\"Which device are you using (iOS, Android, Web)?\\\"\\nOutput:\", \"prompt_hint\": \"standard\"}",
    "metadata": "{\"tags\":[\"graph:step:16\"],\"langgraph_step\":16,\"langgraph_node\":\"prompt_routing\",\"langgraph_triggers\":[\"branch:to:prompt_routing\"],\"langgraph_path\":[\"__pregel_pull\",\"prompt_routing\"],\"langgraph_checkpoint_ns\":\"prompt_routing:0742655c-1887-340a-fe95-7ef388daddc7\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "46df35fa0f18e7f7",
    "type": "SPAN",
    "name": "node_PromptRoutingNode (46df35fa)",
    "startTime": "2026-01-14T11:08:02.230Z",
    "endTime": "2026-01-14T11:08:02.318Z",
    "depth": 2,
    "input": "{\"args\": [{\"clarification_context\": {\"active\": true, \"questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"current_index\": 0, \"answers\": {}, \"original_doc_id\": null, \"original_doc_content\": null, \"requires_handoff\": true, \"target_language\": \"bg\"}, \"state_behavior\": {\"tone\": \"professional\", \"action\": \"auto_reply\", \"prompt_hint\": \"standard\"}, \"_session_history_loader\": {}, \"aggregated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"conversation_history\": [], \"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"docs\": [\"Question: I have a technical issue with the app\\nAnswer: Please try clearing your cache or reinstalling the application. If the problem persists, contact support.\"], \"extracted_entities\": {}, \"dialog_state\": \"NEEDS_CLARIFICATION\", \"detected_language\": \"bg\", \"user_profile\": {\"exists\": true, \"name\": \"\\u0410\\u0440\\u0442\\u0435\\u043c\", \"memory\": {}, \"last_seen\": \"2026-01-12T18:42:15.227112+00:00\"}}], \"kwargs\": {}}",
    "output": "{\"system_prompt\": \"You are a precise technical assistant. Your ONLY task is to ask the specific question provided below. Translate the question to 'bg' (Russian/Spanish/etc) to match the user. Do NOT answer the question. Do NOT add pleasantries. Do NOT hallucinate new questions.\", \"human_prompt\": \"User's previous input: \\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\\n--------------------------------------------------\\nTASK: Ask this EXACT question: \\\"Which device are you using (iOS, Android, Web)?\\\"\\nOutput:\", \"prompt_hint\": \"standard\"}",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "d341612ee9242eb6",
    "type": "CHAIN",
    "name": "generation (d341612e)",
    "startTime": "2026-01-14T11:08:02.320Z",
    "endTime": "2026-01-14T11:08:02.321Z",
    "depth": 1,
    "input": "{\"escalation_message\": null, \"aggregated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"human_prompt\": \"User's previous input: \\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\\n--------------------------------------------------\\nTASK: Ask this EXACT question: \\\"Which device are you using (iOS, Android, Web)?\\\"\\nOutput:\", \"answer\": \"\\u041a\\u043e\\u0439 \\u0443\\u0441\\u0442\\u0440\\u043e\\u0439\\u0441\\u0442\\u0432\\u043e \\u0438\\u0437\\u043f\\u043e\\u043b\\u0437\\u0432\\u0430\\u0442\\u0435 (iOS, Android, Web)?\", \"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"system_prompt\": \"You are a precise technical assistant. Your ONLY task is to ask the specific question provided below. Translate the question to 'bg' (Russian/Spanish/etc) to match the user. Do NOT answer the question. Do NOT add pleasantries. Do NOT hallucinate new questions.\", \"dialog_state\": \"NEEDS_CLARIFICATION\"}",
    "output": "{\"answer\": \"\\u041a\\u043e\\u0439 \\u0443\\u0441\\u0442\\u0440\\u043e\\u0439\\u0441\\u0442\\u0432\\u043e \\u0438\\u0437\\u043f\\u043e\\u043b\\u0437\\u0432\\u0430\\u0442\\u0435 (iOS, Android, Web)?\"}",
    "metadata": "{\"tags\":[\"graph:step:17\"],\"langgraph_step\":17,\"langgraph_node\":\"generation\",\"langgraph_triggers\":[\"branch:to:generation\"],\"langgraph_path\":[\"__pregel_pull\",\"generation\"],\"langgraph_checkpoint_ns\":\"generation:e0260159-37f2-8135-bca0-1e81c19da3f5\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "e0dac8b8394cd42c",
    "type": "SPAN",
    "name": "node_GenerationNode (e0dac8b8)",
    "startTime": "2026-01-14T11:08:02.320Z",
    "endTime": "2026-01-14T11:08:02.320Z",
    "depth": 2,
    "input": "{\"args\": [{\"escalation_message\": null, \"aggregated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"human_prompt\": \"User's previous input: \\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\\n--------------------------------------------------\\nTASK: Ask this EXACT question: \\\"Which device are you using (iOS, Android, Web)?\\\"\\nOutput:\", \"answer\": \"\\u041a\\u043e\\u0439 \\u0443\\u0441\\u0442\\u0440\\u043e\\u0439\\u0441\\u0442\\u0432\\u043e \\u0438\\u0437\\u043f\\u043e\\u043b\\u0437\\u0432\\u0430\\u0442\\u0435 (iOS, Android, Web)?\", \"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"docs\": [\"Question: I have a technical issue with the app\\nAnswer: Please try clearing your cache or reinstalling the application. If the problem persists, contact support.\"], \"system_prompt\": \"You are a precise technical assistant. Your ONLY task is to ask the specific question provided below. Translate the question to 'bg' (Russian/Spanish/etc) to match the user. Do NOT answer the question. Do NOT add pleasantries. Do NOT hallucinate new questions.\", \"dialog_state\": \"NEEDS_CLARIFICATION\"}], \"kwargs\": {}}",
    "output": "{\"answer\": \"\\u041a\\u043e\\u0439 \\u0443\\u0441\\u0442\\u0440\\u043e\\u0439\\u0441\\u0442\\u0432\\u043e \\u0438\\u0437\\u043f\\u043e\\u043b\\u0437\\u0432\\u0430\\u0442\\u0435 (iOS, Android, Web)?\"}",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "6f2fc15702fddc3a",
    "type": "CHAIN",
    "name": "archive_session (6f2fc157)",
    "startTime": "2026-01-14T11:08:02.321Z",
    "endTime": "2026-01-14T11:08:02.356Z",
    "depth": 1,
    "input": "{\"clarification_context\": {\"active\": true, \"questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"current_index\": 0, \"answers\": {}, \"original_doc_id\": null, \"original_doc_content\": null, \"requires_handoff\": true, \"target_language\": \"bg\"}, \"sentiment\": {\"label\": \"neutral\", \"score\": 0.3}, \"escalation_triggered\": false, \"answer\": \"\\u041a\\u043e\\u0439 \\u0443\\u0441\\u0442\\u0440\\u043e\\u0439\\u0441\\u0442\\u0432\\u043e \\u0438\\u0437\\u043f\\u043e\\u043b\\u0437\\u0432\\u0430\\u0442\\u0435 (iOS, Android, Web)?\", \"escalation_reason\": null, \"session_id\": \"tg_sess_480637186\", \"user_id\": \"067e0880-7b26-4aaf-abb9-40fb8331c923\", \"dialog_state\": \"NEEDS_CLARIFICATION\", \"attempt_count\": 0, \"detected_language\": \"bg\", \"clarified_doc_ids\": [], \"translated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"conversation_history\": [], \"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"matched_intent\": \"technical_issue\", \"extracted_entities\": {}, \"confidence\": 0.5000080466270447, \"safety_violation\": false}",
    "output": "{\"session_archived\": true}",
    "metadata": "{\"tags\":[\"graph:step:18\"],\"langgraph_step\":18,\"langgraph_node\":\"archive_session\",\"langgraph_triggers\":[\"branch:to:archive_session\"],\"langgraph_path\":[\"__pregel_pull\",\"archive_session\"],\"langgraph_checkpoint_ns\":\"archive_session:3c0418ae-7c43-c2b4-c896-dce95a637d9b\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "1c84b030c0c62643",
    "type": "SPAN",
    "name": "node_archive_session (1c84b030)",
    "startTime": "2026-01-14T11:08:02.322Z",
    "endTime": "2026-01-14T11:08:02.355Z",
    "depth": 2,
    "input": "{\"args\": [{\"clarification_context\": {\"active\": true, \"questions\": [\"Which device are you using (iOS, Android, Web)?\", \"What version of the app do you have?\", \"Can you describe the error or behavior?\"], \"current_index\": 0, \"answers\": {}, \"original_doc_id\": null, \"original_doc_content\": null, \"requires_handoff\": true, \"target_language\": \"bg\"}, \"docs\": [\"Question: I have a technical issue with the app\\nAnswer: Please try clearing your cache or reinstalling the application. If the problem persists, contact support.\"], \"sentiment\": {\"label\": \"neutral\", \"score\": 0.3}, \"escalation_triggered\": false, \"answer\": \"\\u041a\\u043e\\u0439 \\u0443\\u0441\\u0442\\u0440\\u043e\\u0439\\u0441\\u0442\\u0432\\u043e \\u0438\\u0437\\u043f\\u043e\\u043b\\u0437\\u0432\\u0430\\u0442\\u0435 (iOS, Android, Web)?\", \"escalation_reason\": null, \"session_id\": \"tg_sess_480637186\", \"user_id\": \"067e0880-7b26-4aaf-abb9-40fb8331c923\", \"dialog_state\": \"NEEDS_CLARIFICATION\", \"attempt_count\": 0, \"detected_language\": \"bg\", \"clarified_doc_ids\": [], \"translated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"conversation_history\": [], \"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"matched_intent\": \"technical_issue\", \"extracted_entities\": {}, \"confidence\": 0.5000080466270447, \"safety_violation\": false}], \"kwargs\": {}}",
    "output": "{\"session_archived\": true}",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "97ea3d485fa53048",
    "type": "CHAIN",
    "name": "store_in_cache (97ea3d48)",
    "startTime": "2026-01-14T11:08:02.357Z",
    "endTime": "2026-01-14T11:08:02.358Z",
    "depth": 1,
    "input": "{\"translated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"answer\": \"\\u041a\\u043e\\u0439 \\u0443\\u0441\\u0442\\u0440\\u043e\\u0439\\u0441\\u0442\\u0432\\u043e \\u0438\\u0437\\u043f\\u043e\\u043b\\u0437\\u0432\\u0430\\u0442\\u0435 (iOS, Android, Web)?\", \"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"cache_hit\": false, \"confidence\": 0.5000080466270447, \"cache_key\": \"\\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443 \\u043e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e\"}",
    "output": "{}",
    "metadata": "{\"tags\":[\"graph:step:19\"],\"langgraph_step\":19,\"langgraph_node\":\"store_in_cache\",\"langgraph_triggers\":[\"branch:to:store_in_cache\"],\"langgraph_path\":[\"__pregel_pull\",\"store_in_cache\"],\"langgraph_checkpoint_ns\":\"store_in_cache:5a9ba3f0-c324-17cc-3071-59380582ed74\",\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  },
  {
    "id": "8e136742735f38e2",
    "type": "SPAN",
    "name": "node_StoreInCacheNode (8e136742)",
    "startTime": "2026-01-14T11:08:02.357Z",
    "endTime": "2026-01-14T11:08:02.358Z",
    "depth": 2,
    "input": "{\"args\": [{\"translated_query\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"answer\": \"\\u041a\\u043e\\u0439 \\u0443\\u0441\\u0442\\u0440\\u043e\\u0439\\u0441\\u0442\\u0432\\u043e \\u0438\\u0437\\u043f\\u043e\\u043b\\u0437\\u0432\\u0430\\u0442\\u0435 (iOS, Android, Web)?\", \"question\": \"\\u041e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e, \\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443?\", \"docs\": [\"Question: I have a technical issue with the app\\nAnswer: Please try clearing your cache or reinstalling the application. If the problem persists, contact support.\"], \"cache_hit\": false, \"confidence\": 0.5000080466270447, \"cache_key\": \"\\u0430 \\u043a\\u0440\\u0438\\u043f\\u0442\\u0443 \\u043e\\u0442\\u043b\\u0438\\u0447\\u043d\\u043e\"}], \"kwargs\": {}}",
    "output": "{}",
    "metadata": "{\"resourceAttributes\":{\"telemetry.sdk.language\":\"python\",\"telemetry.sdk.name\":\"opentelemetry\",\"telemetry.sdk.version\":\"1.39.1\",\"service.name\":\"unknown_service\"},\"scope\":{\"name\":\"langfuse-sdk\",\"version\":\"3.12.0\",\"attributes\":{\"public_key\":\"pk-lf-13625d94-6432-4e0d-aacc-59ab76ddc5c5\"}}}"
  }
]